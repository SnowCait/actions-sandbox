name: PR diff

on:
  pull_request:
    paths:
      - .github/workflows/diff.yml

jobs:
  diff:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    env:
      GH_TOKEN: ${{ github.token }}
      GH_REPO: ${{ github.repository }}
      number: ${{ github.event.number }}
    steps:
      - run: gh pr diff ${number}
      - run: gh pr diff ${number} --name-only
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - run: ls -la
      - run: git diff origin/${GITHUB_BASE_REF}...origin/${GITHUB_HEAD_REF}
      - run: git diff origin/${GITHUB_BASE_REF}..origin/${GITHUB_HEAD_REF}
      - run: git diff origin/${GITHUB_BASE_REF} origin/${GITHUB_HEAD_REF}

      - uses: tj-actions/changed-files@v34
        id: changed-files
      - run: echo "${json}"
        env:
          json: ${{ toJSON(steps.changed-files.outputs) }}
